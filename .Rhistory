library(plyr)
library(tidyverse)
library(readxl)
library(writexl)
library(mctoolsr)
library(vegan)
library(microseq)
library(FSA)
library(car)
library(RColorBrewer)
library(scales)
library(ggrepel)
library(cowplot)
library(ggh4x)
library(pheatmap)
library(ANCOMBC)
library(phyloseq)
library(DESeq2)
BiocManager::install("DESeq2")
library(DESeq2)
library(KEGGREST)
library(VennDiagram)
library(ggvenn)
# Functions
`%notin%` <- Negate(`%in%`)
find_hull <- function(df) df[chull(df$Axis01, df$Axis02),]
# cliffplot
source("~/Documents/GitHub/SunflowerGxE/code/cliffplot_taxa_bars.R")
# Effect size (from Jack Darcy, Science Advances 2018)
source("~/Documents/GitHub/Sunflower_AEM/code/effectSize.R")
# Working directory
setwd("~/Documents/GitHub/AndesAg/")
# Functions
`%notin%` <- Negate(`%in%`)
find_hull <- function(df) df[chull(df$Axis01, df$Axis02),]
# cliffplot
source("code/cliffplot_taxa_bars.R")
# Effect size (from Jack Darcy, Science Advances 2018)
source("code/effectSize.R")
d1 <- read.csv("data/SampleSheet_24471Fie_N25015_L003.csv") %>%
separate(Sample, remove = F, sep = "_", into = c("Project", "sampleID")) %>%
separate(sampleID, remove = F, sep = "-", into = c("Group", "Replicate", "Depth")) %>%
mutate(sampleID = gsub("-", ".", sampleID)) %>%
mutate(Sample = sampleID) %>%
rename("PfClusterCount" = "Reads") %>%
mutate(Treatment = ifelse(Group == "A", "+MP1",
ifelse(Group == "B", "+Basalt",
ifelse(Group == "C", "+MP1+Basalt",
ifelse(Group == "D", "Control", "Blank"))))) %>%
mutate(MP1 = ifelse(Group == "A" | Group == "C", "MP1",
ifelse(Group == "B" | Group == "D", "Control", "Blank"))) %>%
mutate(Basalt = ifelse(Group == "B" | Group == "C", "Basalt",
ifelse(Group == "A" | Group == "D", "Control", "Blank"))) %>%
filter(Treatment != "Blank") %>% # Go ahead and remove, few seqs
dplyr::select(Sample, everything())
View(d1)
write.table(d1, "metadata.txt", sep = "\t", row.names = F)
#write.table(d1, "metadata.txt", sep = "\t", row.names = F)
d1$sampleID
table(d1$Group)
table(d1$Replicate)
table(d1$Depth)
table(d1$Treatment)
table(d1$MP1)
table(d1$Basalt)
# Barcodes (thought were needed but didn't end up using)
bcf <- d1 %>%
dplyr::select(Barcode1) %>%
mutate(BC = "Barcode") %>%
mutate(Num = seq(1:nrow(.))) %>%
mutate(Header = paste0(BC, Num)) %>%
dplyr::rename(Sequence = Barcode1) %>%
dplyr::select(Header, Sequence)
bcr <- d1 %>%
dplyr::select(Barcode2) %>%
mutate(BC = "Barcode") %>%
mutate(Num = seq(1:nrow(.))) %>%
mutate(Header = paste0(BC, Num)) %>%
dplyr::rename(Sequence = Barcode2) %>%
dplyr::select(Header, Sequence) %>%
add_case(Header = "Barcode76", Sequence = "GGGGGGGGGG")
# Check sequencing depth
ggplot(d1, aes(Treatment, Reads)) +
geom_boxplot(outliers = F) +
geom_jitter(width = 0.25, pch = 16, size = 2) +
theme_bw()
ggplot(d1, aes(Depth, Reads)) +
geom_boxplot(outliers = F) +
geom_jitter(width = 0.25, pch = 16, size = 2) +
theme_bw()
View(d1)
# Check sequencing depth of concatenated lanes, trimmed and filtered
# for n = 70 samples analyzed (dropped 2 samples and 3 blanks)
rc <- read.delim("data/read_counts.txt", header = F) %>%
separate(V1, into = c("sampleID", "ReadsAll", "Junk"), sep = " ") %>%
mutate(sampleID = gsub("_R1_combined.fastq.gz:", "", sampleID)) %>%
mutate(sampleID = gsub("B1/", "", sampleID)) %>%
mutate(sampleID = gsub("B2/", "", sampleID)) %>%
mutate(sampleID = gsub("B3/", "", sampleID)) %>%
mutate(sampleID = gsub("B4/", "", sampleID)) %>%
mutate(sampleID = gsub("-", ".", sampleID)) %>%
mutate(ReadsAll = as.integer(ReadsAll)) %>%
dplyr::select(-Junk) %>%
left_join(., d1, by = c("sampleID" = "Sample")) %>%
mutate(SampleID = gsub("\\.", "_", sampleID))
mean(rc$ReadsAll)
se(rc$ReadsAll)
range(rc$ReadsAll)
ggplot(rc, aes(Treatment, ReadsAll)) +
geom_boxplot(outliers = F) +
geom_jitter(width = 0.25, pch = 16, size = 2) +
theme_bw()
ggplot(rc, aes(Depth, ReadsAll)) +
geom_boxplot(outliers = F) +
geom_jitter(width = 0.25, pch = 16, size = 2) +
theme_bw()
#### __Prok ####
input_filt_rare <- readRDS("data/input_filt_rare_mtagsProk_all.rds")
input_filt_rare$map_loaded <- input_filt_rare$map_loaded %>%
mutate(Treatment = factor(Treatment,
levels = c("Control",
"+Basalt",
"+MP1",
"+MP1+Basalt"))) %>%
mutate(Treatment = case_match(Treatment,
"Control" ~ "UTC",
"+Basalt" ~ "UTC+B",
"+MP1" ~ "MP1",
"+MP1+Basalt" ~ "MP1+B")) %>%
mutate(Treatment = factor(Treatment,
levels = c("UTC", "MP1", "UTC+B", "MP1+B"))) %>%
mutate(Depth = as.factor(Depth)) %>%
mutate(TrtDep = factor(paste(Treatment, Depth, sep = "_"),
levels = c("Control_10", "Control_20", "Control_30",
"+Basalt_10", "+Basalt_20", "+Basalt_30",
"+MP1_10", "+MP1_20", "+MP1_30",
"+MP1+Basalt_10", "+MP1+Basalt_20",
"+MP1+Basalt_30")))
# Got soil data later, import and merge that
# Note: Alk data is just 1 per column so repeated values
soil <- read.csv("andes_cs5_compiled_soil_data.csv") %>%
mutate(Comb = paste(Treatment, Condition, sep = "_")) %>%
mutate(Group = ifelse(Comb == "MP1_Basalt", "C",
ifelse(Comb == "MP1_NB", "A",
ifelse(Comb == "UTC_Basalt", "B", "D")))) %>%
mutate(Comb = gsub("MP1_Basalt", "+MP1+Basalt", Comb)) %>%
mutate(Comb = gsub("MP1_NB", "+MP1", Comb)) %>%
mutate(Comb = gsub("UTC_Basalt", "+Basalt", Comb)) %>%
mutate(Comb = gsub("UTC_NB", "Control", Comb)) %>%
mutate(Treatment = factor(Comb,
levels = c("Control",
"+Basalt",
"+MP1",
"+MP1+Basalt"))) %>%
mutate(Treatment = case_match(Treatment,
"Control" ~ "UTC",
"+Basalt" ~ "UTC+B",
"+MP1" ~ "MP1",
"+MP1+Basalt" ~ "MP1+B")) %>%
mutate(Treatment = factor(Treatment,
levels = c("UTC", "MP1", "UTC+B", "MP1+B"))) %>%
mutate(sampleID = paste(Group, Column, Increment, sep = ".")) %>%
dplyr::select(-Treatment, -Condition, -Increment, -Column, -Comb, -Group) %>%
dplyr::select(sampleID, everything())
# Got soil data later, import and merge that
# Note: Alk data is just 1 per column so repeated values
soil <- read.csv("data/andes_cs5_compiled_soil_data.csv") %>%
mutate(Comb = paste(Treatment, Condition, sep = "_")) %>%
mutate(Group = ifelse(Comb == "MP1_Basalt", "C",
ifelse(Comb == "MP1_NB", "A",
ifelse(Comb == "UTC_Basalt", "B", "D")))) %>%
mutate(Comb = gsub("MP1_Basalt", "+MP1+Basalt", Comb)) %>%
mutate(Comb = gsub("MP1_NB", "+MP1", Comb)) %>%
mutate(Comb = gsub("UTC_Basalt", "+Basalt", Comb)) %>%
mutate(Comb = gsub("UTC_NB", "Control", Comb)) %>%
mutate(Treatment = factor(Comb,
levels = c("Control",
"+Basalt",
"+MP1",
"+MP1+Basalt"))) %>%
mutate(Treatment = case_match(Treatment,
"Control" ~ "UTC",
"+Basalt" ~ "UTC+B",
"+MP1" ~ "MP1",
"+MP1+Basalt" ~ "MP1+B")) %>%
mutate(Treatment = factor(Treatment,
levels = c("UTC", "MP1", "UTC+B", "MP1+B"))) %>%
mutate(sampleID = paste(Group, Column, Increment, sep = ".")) %>%
dplyr::select(-Treatment, -Condition, -Increment, -Column, -Comb, -Group) %>%
dplyr::select(sampleID, everything())
dim(input_filt_rare$map_loaded)
rownames(input_filt_rare$map_loaded)
input_filt_rare$map_loaded <- input_filt_rare$map_loaded %>%
left_join(., soil, by = "sampleID")
dim(input_filt_rare$map_loaded)
rownames(input_filt_rare$map_loaded) <- input_filt_rare$map_loaded$sampleID
# Check soil correlations
soil <- input_filt_rare$map_loaded %>%
dplyr::select(17:37)
m <- cor(soil)
corrplot(m,
method = "square",
type = "lower",
diag = FALSE,
hclust.method = "ward.D2",
tl.cex = 0.5)
library(corrplot)
corrplot(m,
method = "square",
type = "lower",
diag = FALSE,
hclust.method = "ward.D2",
tl.cex = 0.5)
# PCA of soil
pca <- rda(soil, scale = TRUE)  # `scale=TRUE` standardizes variables
summary(pca)
plot(pca, scaling = 2, type = "n")  # type = "n" plots empty frame
points(pca, display = "sites", scaling = 2, pch = 21, bg = "lightblue")
species_scores <- scores(pca, display = "species", scaling = 2)
arrows(0, 0, species_scores[, 1], species_scores[, 2], length = 0.1, col = "red")
text(species_scores[, 1], species_scores[, 2], labels = rownames(species_scores),
col = "red", cex = 0.8, pos = 3)
sites_scores <- scores(pca, display = "sites", scaling = 2)
species_scores <- scores(pca, display = "species", scaling = 2)
vec.df <- as.data.frame(species_scores) %>%
mutate(shortnames = rownames(.))
pcaA1 <- paste("PC1: ", round((eigenvals(pca)/sum(eigenvals(pca)))[1]*100, 1), "%")
pcaA2 <- paste("PC2: ", round((eigenvals(pca)/sum(eigenvals(pca)))[2]*100, 1), "%")
input_filt_rare$map_loaded$Axis01 <- sites_scores[,1]
input_filt_rare$map_loaded$Axis02 <- sites_scores[,2]
micro.hulls <- ddply(input_filt_rare$map_loaded, c("Treatment"), find_hull)
ggplot(input_filt_rare$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls, aes(colour = Treatment, fill = Treatment),
alpha = 0.1, show.legend = F, linewidth = NA) +
geom_point(size = 3, alpha = 1, shape = 21, aes(fill = Treatment)) +
geom_segment(data = vec.df,
aes(x = 0, xend = PC1, y = 0, yend = PC2),
arrow = arrow(length = unit(0.35, "cm")),
colour = "gray", alpha = 0.6,
inherit.aes = FALSE) +
geom_text_repel(data = vec.df,
aes(x = PC1, y = PC2, label = shortnames),
size = 3, color = "red") +
labs(x = pcaA1,
y = pcaA2,
fill = "Treatment") +
scale_colour_viridis_d() +
scale_fill_viridis_d() +
guides(fill = guide_legend(override.aes = list(alpha = 1, shape = 23, size = 4))) +
theme_bw() +
theme(legend.position = "right",
legend.box.margin = margin(0,0,100,0, unit = "pt"),
axis.title = element_text(face = "bold", size = 12),
axis.text = element_text(size = 10),
panel.grid = element_blank())
# Check taxa
cliffplot_taxa_bars(input_filt_rare, 2, variable = "sampleID")
out <- readRDS("data/ancom_out_prok_all.rds")
#### All Lanes ####
# Reran sylph on all lanes concatenated
strains_sylph_raw <- read.delim("sylph_profile_andes_comb.tsv") %>%
mutate(GenomeID = gsub("gtdb_genomes_reps_r220/database/", "", Genome_file)) %>%
mutate(GenomeID = gsub("_genomic.fna.gz", "", GenomeID)) %>%
mutate(GenomeID = ifelse(nchar(GenomeID) > 9,
substr(GenomeID, start = 17, stop = nchar(GenomeID)),
GenomeID))
#### All Lanes ####
# Reran sylph on all lanes concatenated
strains_sylph_raw <- read.delim("data/sylph_profile_andes_comb.tsv") %>%
mutate(GenomeID = gsub("gtdb_genomes_reps_r220/database/", "", Genome_file)) %>%
mutate(GenomeID = gsub("_genomic.fna.gz", "", GenomeID)) %>%
mutate(GenomeID = ifelse(nchar(GenomeID) > 9,
substr(GenomeID, start = 17, stop = nchar(GenomeID)),
GenomeID))
strains_sylph <- read.delim("data/sylph_profile_andes_comb.tsv") %>%
mutate(SampleID = gsub("/scratch/alpine/clbd1748/AndesAg/Comb/", "", Sample_file)) %>%
mutate(SampleID = substr(SampleID, start = 1, stop = 7)) %>%
mutate(SampleID = gsub("-", ".", SampleID)) %>%
mutate(GenomeID = gsub("gtdb_genomes_reps_r220/database/", "", Genome_file)) %>%
mutate(GenomeID = gsub("_genomic.fna.gz", "", GenomeID)) %>%
mutate(GenomeID = ifelse(nchar(GenomeID) > 9,
substr(GenomeID, start = 17, stop = nchar(GenomeID)),
GenomeID)) %>%
filter(SampleID %in% d_sort$sampleID)
#### Lane 1 ####
#### __All ####
d_sort <- input_filt_rare$map_loaded %>%
arrange(sampleID)
d_sort$sampleID
strains_sylph_raw <- read.delim("data/sylph_profile_andes_comb.tsv") %>%
mutate(GenomeID = gsub("gtdb_genomes_reps_r220/database/", "", Genome_file)) %>%
mutate(GenomeID = gsub("_genomic.fna.gz", "", GenomeID)) %>%
mutate(GenomeID = ifelse(nchar(GenomeID) > 9,
substr(GenomeID, start = 17, stop = nchar(GenomeID)),
GenomeID))
strains_sylph <- read.delim("data/sylph_profile_andes_comb.tsv") %>%
mutate(SampleID = gsub("/scratch/alpine/clbd1748/AndesAg/Comb/", "", Sample_file)) %>%
mutate(SampleID = substr(SampleID, start = 1, stop = 7)) %>%
mutate(SampleID = gsub("-", ".", SampleID)) %>%
mutate(GenomeID = gsub("gtdb_genomes_reps_r220/database/", "", Genome_file)) %>%
mutate(GenomeID = gsub("_genomic.fna.gz", "", GenomeID)) %>%
mutate(GenomeID = ifelse(nchar(GenomeID) > 9,
substr(GenomeID, start = 17, stop = nchar(GenomeID)),
GenomeID)) %>%
filter(SampleID %in% d_sort$sampleID)
length(unique(strains_sylph$SampleID)) # 70 samples
length(unique(strains_sylph$GenomeID)) # 398/113,104 + 1
sylph_strains_70 <- strains_sylph %>%
dplyr::select(SampleID, GenomeID, Sequence_abundance) %>%
pivot_wider(names_from = SampleID, values_from = Sequence_abundance) %>%
mutate(Type = ifelse(GenomeID == "MP1.fasta", "MP1", "GTDB")) %>%
column_to_rownames(var = "GenomeID") %>%
dplyr::select(all_of(d_sort$sampleID)) %>%
replace(is.na(.), 0)
ubiq <- sylph_strains_70 %>%
mutate(Ubiquity = rowSums(across(everything(), ~ . > 0))) %>%
mutate(MeanAbund = rowMeans(across(everything()))) %>%
rownames_to_column(var = "GenomeID") %>%
dplyr::select(GenomeID, Ubiquity, MeanAbund) %>%
arrange(desc(Ubiquity), desc(MeanAbund))
sum(ubiq$Ubiquity == 70)
df_10 <- sylph_strains_70 %>% select(contains("10"))
df_20 <- sylph_strains_70 %>% select(contains("20"))
df_30 <- sylph_strains_70 %>% select(contains("30"))
ubiq_10 <- df_10 %>%
mutate(Ubiquity10 = rowSums(across(everything(), ~ . > 0))) %>%
mutate(MeanAbund10 = rowMeans(across(everything()))) %>%
rownames_to_column(var = "GenomeID") %>%
dplyr::select(GenomeID, Ubiquity10, MeanAbund10)
ubiq_20 <- df_20 %>%
mutate(Ubiquity20 = rowSums(across(everything(), ~ . > 0))) %>%
mutate(MeanAbund20 = rowMeans(across(everything()))) %>%
rownames_to_column(var = "GenomeID") %>%
dplyr::select(GenomeID, Ubiquity20, MeanAbund20)
ubiq_30 <- df_30 %>%
mutate(Ubiquity30 = rowSums(across(everything(), ~ . > 0))) %>%
mutate(MeanAbund30 = rowMeans(across(everything()))) %>%
rownames_to_column(var = "GenomeID") %>%
dplyr::select(GenomeID, Ubiquity30, MeanAbund30)
ubiq_depth <- ubiq_10 %>%
left_join(., ubiq_20, by = "GenomeID") %>%
left_join(., ubiq_30, by = "GenomeID") %>%
dplyr::select(GenomeID, Ubiquity10, Ubiquity20, Ubiquity30) %>%
mutate(PresAll = Ubiquity10 > 0 & Ubiquity20 > 0 & Ubiquity30 > 0) %>%
dplyr::select(GenomeID, Ubiquity10, Ubiquity20, Ubiquity30, PresAll)
sum(ubiq_depth$PresAll == TRUE)
gtdb_sylph <- fullGT %>%
filter(grepl(paste(rownames(sylph_strains_70), collapse="|"), accession)) %>% # 181
mutate(ID = substr(accession, start = 4, stop = nchar(accession))) %>%
mutate(gtdb_taxonomy = gsub("d__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("p__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("c__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("o__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("f__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("g__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("s__", "", gtdb_taxonomy)) %>%
separate(gtdb_taxonomy, sep = ";", into = c("Domain", "Phylum", "Class", "Order",
"Family", "Genus", "Species")) %>%
dplyr::select(accession, ID, checkm2_completeness, checkm2_contamination,
Domain, Phylum, Class, Order, Family, Genus, Species) %>%
add_row(accession = "MP1", ID = "MP1.fasta",
checkm2_completeness = 100, checkm2_contamination = 0.01, Domain = "Bacteria",
Phylum = "Bacillota", Class = "Bacilli", Order = "Bacillales",
Family = "Bacillaceae", Genus = "Bacillus", Species = "Bacillus MP1") %>%
arrange(Species)
# GTDB Metadata - big files, not included in GitHub, but can be downloaded from GTDB
bacGT <- read.delim("~/Desktop/Fierer/Strains/bac120_metadata_r220.tsv")
arcGT <- read.delim("~/Desktop/Fierer/Strains/ar53_metadata_r220.tsv")
fullGT <- rbind(bacGT, arcGT)
gtdb_sylph <- fullGT %>%
filter(grepl(paste(rownames(sylph_strains_70), collapse="|"), accession)) %>% # 181
mutate(ID = substr(accession, start = 4, stop = nchar(accession))) %>%
mutate(gtdb_taxonomy = gsub("d__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("p__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("c__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("o__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("f__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("g__", "", gtdb_taxonomy)) %>%
mutate(gtdb_taxonomy = gsub("s__", "", gtdb_taxonomy)) %>%
separate(gtdb_taxonomy, sep = ";", into = c("Domain", "Phylum", "Class", "Order",
"Family", "Genus", "Species")) %>%
dplyr::select(accession, ID, checkm2_completeness, checkm2_contamination,
Domain, Phylum, Class, Order, Family, Genus, Species) %>%
add_row(accession = "MP1", ID = "MP1.fasta",
checkm2_completeness = 100, checkm2_contamination = 0.01, Domain = "Bacteria",
Phylum = "Bacillota", Class = "Bacilli", Order = "Bacillales",
Family = "Bacillaceae", Genus = "Bacillus", Species = "Bacillus MP1") %>%
arrange(Species)
sylph_strains_70 <- strains_sylph %>%
dplyr::select(SampleID, GenomeID, Sequence_abundance) %>%
pivot_wider(names_from = SampleID, values_from = Sequence_abundance) %>%
mutate(Type = ifelse(GenomeID == "MP1.fasta", "MP1", "GTDB")) %>%
left_join(., gtdb_sylph, by = c("GenomeID" = "ID")) %>%
arrange(Species) %>%
column_to_rownames(var = "Species") %>%
dplyr::select(all_of(d_sort$sampleID)) %>%
replace(is.na(.), 0)
ann_cols <- data.frame(row.names = colnames(sylph_strains_70),
Depth = d_sort$Depth,
Treatment = d_sort$Treatment)
ann_rows <- data.frame(row.names = rownames(sylph_strains_70)) %>%
mutate(Type = ifelse(rownames(.) == "Bacillus MP1", "MP1", "GTDB"),
Domain = gtdb_sylph$Domain,
#Completeness = gtdb_sylph$checkm2_completeness,
#Contamination = gtdb_sylph$checkm2_contamination
)
table(ann_rows$Type)
ann_colors <- list(Type = c("GTDB" = "grey90",
"MP1" = "red"),
Domain = c("Archaea" = "#F8766D",
"Bacteria" = "#619CFF"),
Treatment = c("Control" = "#440154FF",
"+Basalt" = "#31688EFF",
"+MP1" = "#35B779FF",
"+MP1+Basalt" = "#FDE725FF"),
Depth = c("10" = "grey80",
"20" = "grey50",
"30" = "grey20"))
max(sylph_strains_70)
min(sylph_strains_70[sylph_strains_70 > 0], na.rm = TRUE)
breaks <- c(0, seq(0.0074, 21.9267, length.out = 100))
colors <- c("white", colorRampPalette(brewer.pal(9, "Reds"))(99))
# qPCR
qPCR <- read_xlsx("data/phili, SYBR Green, 08-13-2025, 07Hr 47Min - Text Report.xlsx",
sheet = 2) %>%
mutate(Treatment = factor(Treatment,
levels = c("UTC", "MP1", "UTC+B", "MP1+B")))
d_sort$Depth <- as.factor(d_sort$Depth)
mp1 <- as.data.frame(t(sylph_strains_70)) %>%
dplyr::select(`Bacillus MP1`) %>%
rownames_to_column(var = "sampleID")
sum(d_sort$sampleID != mp1$sampleID)
d_sort$MP1_sylph <- mp1$`Bacillus MP1`
leveneTest(d_sort$MP1_sylph ~ d_sort$Treatment) # Homogeneous
leveneTest(d_sort$MP1_sylph ~ d_sort$Depth) # Homogeneous
m <- aov(MP1_sylph ~ MP1 + Basalt + MP1:Basalt + Depth, data = d_sort)
summary(m)
Anova(m, type = "III", singular.ok = TRUE) # Depth
hist(m$residuals)
shapiro.test(m$residuals)
plot(m$fitted.values, m$residuals)
mp1.sylph <- ggplot(d_sort, aes(Treatment, MP1_sylph, shape = Depth)) +
geom_boxplot(outliers = F, show.legend = F, aes(colour = Treatment)) +
geom_point(size = 3, alpha = 1, position = position_jitterdodge(),
aes(fill = Treatment)) +
labs(x = NULL, y = "MP1 % abundance (metagenome)", shape = "Depth (cm)") +
scale_colour_viridis_d() +
scale_fill_viridis_d() +
scale_shape_manual(values = c(21, 24, 22)) +
guides(fill = "none") +
theme_bw() +
theme(legend.position = "inside",,
legend.position.inside = c(0.82, 0.78),
legend.key.size = unit(0.4, "cm"),
legend.background = element_blank(),
panel.grid = element_blank())
mp1.sylph
mp1.sylph
colSums(sylph_strains_70)
# qPCR
qPCR <- read_xlsx("data/phili, SYBR Green, 08-13-2025, 07Hr 47Min - Text Report.xlsx",
sheet = 2) %>%
mutate(Treatment = factor(Treatment,
levels = c("UTC", "MP1", "UTC+B", "MP1+B")))
mp1.qPCR <- ggplot(qPCR, aes(Treatment, CFU)) +
geom_boxplot(outliers = F, show.legend = F, aes(colour = Treatment)) +
geom_jitter(size = 3, alpha = 1, width = 0.2, height = 0,
aes(fill = Treatment), colour = "black", pch = 21) +
labs(x = NULL, y = "CFU/g soil") +
scale_colour_viridis_d() +
scale_fill_viridis_d() +
guides(fill = "none") +
theme_bw() +
theme(legend.position = "right",
panel.grid = element_blank())
mp1.qPCR
plot_grid(mp1.sylph, mp1.qPCR, labels = "AUTO")
